const r=`# Flow — Интернет-магазин (Telegram бот)\r
\r
## Описание проекта\r
\r
Flow — это полнофункциональный Telegram бот для интернет-магазина, специализирующегося на продаже компьютерной периферии и заказе товаров с китайских площадок (Poizon, TaoBao, 1688). Бот автоматизирует процесс расчета стоимости, отслеживания заказов и взаимодействия с клиентами.\r
\r
## Основной функционал\r
\r
### 1. Расчет стоимости товаров\r
\r
Система автоматического расчета стоимости товаров из Китая с учетом:\r
- Курса юаня к рублю (настраивается администратором)\r
- Курса доллара для расчета доставки\r
- Веса товара (с подсказками по стандартным весам)\r
- Комиссии магазина (прогрессивная шкала в зависимости от стоимости товара)\r
- Стоимости доставки (7$ за килограмм)\r
\r
Пользователь вводит стоимость товара в юанях и вес, после чего получает детальный расчет с разбивкой на стоимость товара, доставку и итоговую сумму.\r
\r
### 2. Отслеживание заказов\r
\r
Система отслеживания с 7 статусами:\r
- В обработке\r
- Выкуплен\r
- На складе в Китае\r
- В пути на таможню\r
- Таможня\r
- На складе в Москве\r
- Доставлен\r
\r
Каждый статус имеет свой цвет в Google Таблице для визуального контроля. Пользователи могут отслеживать свои заказы по трек-номеру, видя полную информацию о товарах, включая фото (до 5 фото на товар).\r
\r
### 3. Программа лояльности\r
\r
Система начисления баллов за выполнение заданий:\r
- Оставить отзыв с фото (333 балла)\r
- Оставить видео-отзыв (500 баллов)\r
- Пригласить трех друзей (300 баллов)\r
- Заказать три любых товара (500 баллов)\r
- Сумма всех заказов 10.000₽ (500 баллов)\r
\r
Администратор может настраивать индивидуальные списки заданий для пользователей. Каждый балл равен 1 рублю и может быть использован при оплате заказа.\r
\r
### 4. Услуги моддинга клавиатур\r
\r
Каталог услуг с описанием и ценами:\r
- Смазка свитчей (37₽ за шт.)\r
- Глубокая чистка клавиатуры (1390₽)\r
- Шумоизоляция корпуса (990₽)\r
- Комплексная доработка стабилизаторов (1290₽)\r
- Полная сборка кастома (2990₽)\r
\r
Каждая услуга имеет описание, фото и возможность оформления заказа прямо из бота.\r
\r
### 5. Админ-панель\r
\r
Полнофункциональная админ-панель для управления магазином:\r
- Управление заказами: добавление, редактирование статусов, изменение сумм\r
- Управление товарами: добавление товаров с фото, редактирование, удаление\r
- Управление курсами валют: настройка курсов юаня и доллара\r
- Статистика бота: количество пользователей, активных за 24 часа, заказов\r
- Рассылки: массовая отправка сообщений всем пользователям\r
- Отправка сообщений конкретным пользователям по @username\r
- Управление программой лояльности: начисление/списание баллов, настройка заданий\r
\r
## Технические решения\r
\r
### Архитектура\r
\r
Бот построен на асинхронной архитектуре с использованием:\r
- **aiogram 3.22.0** — современный фреймворк для Telegram ботов\r
- **aiosqlite 0.21.0** — асинхронная работа с базой данных SQLite\r
- **gspread 6.2.1** — интеграция с Google Sheets API\r
\r
### База данных\r
\r
SQLite база данных с следующей структурой:\r
\r
**users** — информация о пользователях:\r
- user_id (PRIMARY KEY)\r
- username, first_name, last_name\r
- joined_at (дата регистрации)\r
\r
**tracks** — заказы:\r
- id (PRIMARY KEY)\r
- track_number (UNIQUE)\r
- status (статус заказа)\r
- total_price (сумма заказа)\r
- user_id (FOREIGN KEY → users)\r
\r
**items** — товары в заказах:\r
- id (PRIMARY KEY)\r
- track_id (FOREIGN KEY → tracks, CASCADE DELETE)\r
- name (наименование)\r
- description (комплектация)\r
\r
**item_photos** — фото товаров:\r
- id (PRIMARY KEY)\r
- item_id (FOREIGN KEY → items, CASCADE DELETE)\r
- file_id (Telegram file_id, до 5 фото на товар)\r
\r
**user_loyalty** — программа лояльности:\r
- user_id (PRIMARY KEY)\r
- points (баллы)\r
- tasks_text (индивидуальный список заданий)\r
\r
**settings** — настройки системы:\r
- key (PRIMARY KEY)\r
- value (значение: курсы валют и др.)\r
\r
**settings_loyalty** — настройки лояльности:\r
- key (PRIMARY KEY)\r
- value (дефолтный список заданий)\r
\r
### Интеграция с Google Sheets\r
\r
Автоматическая синхронизация данных о заказах с Google Таблицей:\r
- При изменении статуса заказа данные автоматически обновляются в таблице\r
- Цветовая индикация статусов для удобства визуального контроля\r
- Столбцы: Трек-номер, Статус, Сумма, ID Пользователя, Логин, Дата обновления\r
- Поддержка добавления новых заказов и обновления существующих\r
\r
### Состояния (FSM)\r
\r
Использование конечного автомата состояний для управления диалогами:\r
- CalculateState — процесс расчета стоимости\r
- TrackOrderState — отслеживание заказа\r
- AdminSettings — настройки администратора\r
- AdminAddItem — добавление товаров\r
- AdminEditItem — редактирование товаров\r
- AdminTrack — редактирование заказов\r
- LoyaltyAdmin — управление лояльностью\r
\r
### Безопасность\r
\r
- Проверка прав администратора перед выполнением административных команд\r
- Валидация входных данных (курсы валют, суммы, количества)\r
- Защита от SQL-инъекций через параметризованные запросы\r
- Обработка ошибок и логирование\r
\r
## Особенности реализации\r
\r
1. **Асинхронность**: Все операции с базой данных и API выполняются асинхронно для обеспечения высокой производительности\r
2. **Каскадное удаление**: При удалении заказа автоматически удаляются все связанные товары и фото\r
3. **Гибкая система заданий**: Администратор может настраивать индивидуальные списки заданий для пользователей\r
4. **Визуальная обратная связь**: Цветовая индикация статусов в Google Таблице\r
5. **Масштабируемость**: Легко добавлять новые статусы, услуги, задания\r
\r
## Результаты\r
\r
- 400+ довольных клиентов\r
- 200+ отзывов\r
- Полная автоматизация процесса заказа и отслеживания\r
- Интеграция с Google Sheets для удобного управления заказами\r
- Программа лояльности повышает вовлеченность клиентов\r
`;export{r as default};
