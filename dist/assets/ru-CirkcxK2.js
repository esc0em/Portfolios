const r=`# Хранитель историй — Telegram бот для анонимного сбора историй\r
\r
## Описание проекта\r
\r
Telegram-бот для анонимного приёма личных историй в рамках проекта «Миллион нерассказанных историй». Пользователи доверяют боту свои истории, которые после анонимизации отправляются модераторам для публикации в канале и возможного использования в сценариях короткометражных фильмов и новелл.\r
\r
## Основной функционал\r
\r
### 1. Пошаговый сценарий (FSM)\r
\r
- **Приветствие** — знакомство с ботом, объяснение условий безопасности и анонимности.\r
- **Согласие с правилами** — подтверждение возраста 18+, условий публикации, согласие на использование истории в сценариях.\r
- **Ввод истории** — пользователь пишет текст в одном или нескольких сообщениях.\r
- **Подтверждение окончания** — кнопка «Да, история закончена».\r
- **Подтверждение отправки** — финальное согласие перед отправкой модераторам.\r
- **Благодарность** — сообщение об успешной отправке и приглашение подписаться на канал.\r
\r
### 2. Анонимизация текста\r
\r
Перед отправкой модераторам автоматически скрываются:\r
\r
- Телефоны (любой формат)\r
- Email\r
- @username\r
- Ссылки (включая t.me)\r
\r
Все перечисленные фрагменты заменяются на «[контакт удалён]».\r
\r
### 3. Рассылка модераторам\r
\r
Отправка историй в группу модераторов с поддержкой топиков (\`message_thread_id\`) для удобной организации обсуждений.\r
\r
### 4. Меню\r
\r
- Правила — свод правил проекта\r
- Как это работает — описание процесса\r
- О проекте — информация о «Миллионе нерассказанных историй»\r
- Ссылка на канал — переход в канал\r
- PDF-документы: свод правил, пользовательское соглашение, политика конфиденциальности\r
\r
### 5. Навигация\r
\r
- Кнопки «Назад», «Меню», «Начать сначала» в зависимости от контекста.\r
- После отказа от отправки — выбор: «Отправить сейчас» или «Переписать историю».\r
\r
## Технические решения\r
\r
### Стек\r
\r
- **Python 3.13** — основной язык.\r
- **aiogram 3.x** — Telegram Bot API, FSM, клавиатуры.\r
- **python-dotenv** — конфигурация из .env (токен бота, ID чата модераторов, ID топика, ссылка на канал, пути к PDF).\r
\r
### FSM\r
\r
Использование \`MemoryStorage\` для состояний сценария. Состояния определяются в \`states/story.py\`.\r
\r
### Анонимизация\r
\r
Модуль \`utils/anonymizer.py\`:\r
\r
- Regex-паттерны для телефонов, email, @username, URL.\r
- Функция \`split_for_telegram()\` — разбиение длинных текстов (>4096 символов) на части для отправки в Telegram.\r
\r
### Деплой\r
\r
- PowerShell-скрипт \`upload_to_server.ps1\` — автоматическая загрузка файлов на сервер.\r
- systemd-сервис \`stories-bot.service\` — запуск бота как демона.\r
\r
## Особенности реализации\r
\r
1. **Без базы данных** — бот не хранит истории, только передаёт их модераторам после анонимизации.\r
2. **Гибкие пути к PDF** — поддержка настройки путей к документам через переменные окружения с fallback на файлы по умолчанию в папке \`files/\`.\r
3. **Topic-based модерация** — отправка в топик группы для структурированного обсуждения.\r
4. **Команда /get_chat_id** — вспомогательная команда для получения ID группы.\r
\r
## Результаты\r
\r
- Анонимный сбор личных историй с защитой персональных данных.\r
- Пошаговый сценарий с подтверждением правил и условий.\r
- Удобная модерация через топики в группе.\r
- Меню с правилами и юридическими документами (PDF) для прозрачности проекта.\r
`;export{r as default};
