# Хаб — Telegram Mini App (бизнес-платформа)

## Описание проекта

Telegram Mini App (веб-приложение внутри Telegram) для производителей, дистрибьюторов и дилеров. Единая платформа с AI-советником, нетворкингом, консультациями, календарём событий, базой знаний и админ-панелью. Построено на React, Express и PostgreSQL с интеграцией бота на Telegraf.

## Целевая аудитория

- Производители
- Дистрибьюторы
- Дилеры

Доступ к разделам регулируется тарифами (free / premium) и ролями (участник / сотрудник компании). Регистрация через заявку с последующим одобрением администратором.

## Основной функционал

### 1. AI-советник

Интеграция с Dify: пользователи задают вопросы, получают ответы с возможностью прикрепления файлов. Учёт тарифа и прав (для сотрудников — доступ только при одобренной анкете руководителя).

### 2. Нетворкинг

Запросы на знакомство между пользователями, фильтры, статусы (pending / принято / отклонено). Лимиты по тарифам (например, 10 запросов в месяц на free). Входящие заявки отображаются на главной.

### 3. Консультации

Запись на консультации по доступным слотам. Заявки хранятся в БД, отображаются в админке. Календарь слотов и управление ими.

### 4. Календарь событий

Просмотр и управление событиями. Интеграция с API событий, отображение в календарном виде.

### 5. База знаний и видео-канал

Раздел с материалами и видео. Для премиум-пользователей — доступ к закрытому Telegram-каналу: проверка членства через API, выдача инвайт-ссылки при необходимости.

### 6. Тарифы и заявки

Экран тарифов (free / premium). Заявки на вступление в Хаб (типы: company, consultation, stanislav). Модерация заявок, одобрение профиля компании и анкеты сотрудника.

### 7. «Моя компания»

Заполнение анкеты компании после одобрения заявки на Хаб. Промежуточный уровень доступа (до полной регистрации).

### 8. Спросить Станислава

Отправка вопросов в отдельный тип заявок с отображением в админке.

### 9. Новости

Лента новостей с возможностью публикации и модерации через админку.

### 10. Админ-панель

Управление пользователями, тикетами, событиями, консультациями, рассылками, запросами на нетворкинг. Назначение админов, блокировка пользователей, управление контентом (новости, видео, превью).

### 11. Анкета сотрудника

Отдельный экран для роли «сотрудник»: заполнение профиля сотрудника, ожидание одобрения работодателем. После одобрения — доступ к AI-советнику и остальным разделам по тарифу.

## Технические решения

### Frontend

- **React 19**, **Vite** (сборка)
- **Tailwind CSS**, **Lucide React** (иконки)
- **@twa-dev/sdk** — интеграция с Telegram Web App (тема, viewport, initData, пользователь)
- Многоэкранная навигация (home, about, tariffs, ai_advisor, networking, calendar, knowledge_base, my_company, news, admin и др.)
- Локализация (ru/en), определение языка из Telegram или localStorage

### Backend

- **Node.js**, **Express 5**
- **PostgreSQL** — пользователи, профили, заявки, нетворкинг, тарифы, события, консультации, новости, модерация, привязка к telegram_id
- **Telegraf** — бот: команды /start, /help, /profile, /stats (для админов), открытие Mini App
- REST API: health, заявки, события, нетворкинг, слоты консультаций, админ-эндпоинты (users, tickets, events, consultations, broadcasts, networking-requests), канал (check-access, invite для видео-канала), загрузка превью и вложений AI

### Роли и доступ

- Роли: member, employee. Проверка is_admin, is_blocked, hub_approved, employer_approved, video_channel_joined.
- Кеширование статуса регистрации в localStorage (5 минут) для быстрого отображения с последующей сверкой с сервером.

### DevOps и безопасность

- **Docker & Docker Compose** — backend, frontend, PostgreSQL, telegram-bot, Nginx
- **Nginx** — прокси, SSL (Let's Encrypt), rate limiting, security headers
- Автоматические бэкапы (cron), скрипт деплоя (deploy.sh): setup, update, backup, status
- Переменные окружения в .env (не в git), non-root пользователи в контейнерах

## Результаты

- 15+ экранов приложения, 12+ функциональных модулей
- Полноценный REST API и интеграция с Dify для AI
- Тарифная модель и двухуровневая модерация (Хаб + компания/сотрудник)
- Готовый продакшен-деплой с Docker, Nginx и бэкапами
